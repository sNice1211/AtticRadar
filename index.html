<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AtticRadar</title>
    <meta name="description" content="A clean, simple, but powerful weather toolkit for the web browser. Includes NEXRAD parsing and plotting, doppler velocity dealiasing, weather alerts, real time lightning data, METAR station data, and much more.">
    <link rel="icon" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <script>
        //var isMobile = ('ontouchstart' in document.documentElement && /mobi/i.test(navigator.userAgent));
        //if (window.location.hash != '#reload') {
        //    window.location.hash += '#reload';
        //}
    </script>

    <!-- 
        THIS IS JUST CSS THAT NEEDS TO BE LOADED BEFORE THE MAIN CSS FILE
    -->
    <style>
        /* https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.css */
        :root {
            --bs-font-sans-serif: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", "Noto Sans", "Liberation Sans", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --bs-font-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            --bs-body-font-family: var(--bs-font-sans-serif);
            --bs-body-font-size: 1rem;
            --bs-body-font-weight: 400;
            --bs-body-line-height: 1.5;
            --bs-body-color: #212529;
            --bs-gutter-x: 1.5rem;
            --bs-gutter-y: 0;
        }

        html {
            overflow: hidden;
        }

        body {
            font-family: var(--bs-body-font-family);
            font-size: var(--bs-body-font-size);
            font-weight: var(--bs-body-font-weight);
            line-height: var(--bs-body-line-height);
            color: var(--bs-body-color);
        }

        body {
            margin: 0;
            padding: 0;

            background-color: rgb(75, 75, 75);
        }
        #loadingLibrariesDiv {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            z-index: 500000;

            background: url('./logo.png') no-repeat center fixed, #7b7b7b;
            background-size: contain;
        }
        #loadingLibrariesDivContent {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            z-index: 500000;

            color: rgb(200, 200, 200);
            background-color: rgba(0, 0, 0, .5);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);

            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;

            /*font-family: 'Abel';*/
            font-size: 50px;
            font-weight: bold;
        }
        .progress_bar {
            position: absolute;
            /* width: 100%; */
            height: 30px;
            bottom: 25%;
            left: 20vw;
            right: 20vw;
            z-index: 500000;

            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;

            background-color: rgb(103, 103, 103);
            border-radius: 10px;
        }
        .progress_bar_inner {
            position: absolute;
            top: 4px;
            bottom: 4px;
            left: 4px;
            /* right: 4px; */

            background-color: rgb(51, 51, 51);
            border-radius: 10px;
        }
        .progress_bar_text {
            position: absolute;
            z-index: 500001;

            color: rgb(205, 205, 205);
            font-size: 15px;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div id="loadingLibrariesDiv">
        <div id="loadingLibrariesDivContent">AtticRadar</div>
        <div id="loadingLibrariesProgressBar" class="progress_bar">
            <span id="progressBarText" class="progress_bar_text"></span>
            <div id="loadingLibrariesProgressBarInner" class="progress_bar_inner"></div>
        </div>
    </div>

    <div id="bodyDiv">

    <div id="progress_bar_screen_background">
        <div id="mainProgressBar" class="progress_bar" style="bottom: calc(50% - 15px); box-shadow: 0px 0px 20px 8px rgb(25, 25, 25);">
            <span id="mainProgressBarText" class="progress_bar_text"></span>
            <div id="mainProgressBarInner" class="progress_bar_inner"></div>
        </div>
    </div>

    <!-- <input type="text" id="gateRes" value="500" style="position: absolute; z-index: 1237109230; left: 200px">
    <br>
    <input type="text" id="multiplier" value="2" style="position: absolute; z-index: 1237109230; left: 200px"> -->
    <!--
        MAP FOOTER
    -->
    <div id="mapFooter" class="mapFooter">
        <div id="productMapFooter" style="display: none">
            <div id="productsDropdownTrigger" class="noselect pdt"><div id="productsDropdownTriggerText" class="icon-blue pdt">Products</div>
                <div id="extraProductInfo" class="noselect" style="display: none">Info</div>
            </div>
            <div id="radarDateTime" class="noselect" style="display: none">Date & Time</div>
        </div>

        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="stationMenuItemDiv" class="mapFooterMenuItem">
            <span id="stationMenuItemIcon" class="fa fa-satellite-dish icon-grey menu_item_not_selected"></span>
        </div>
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="alertMenuItemDiv" class="mapFooterMenuItem">
            <span id="alertMenuItemIcon" class="fa fa-circle-exclamation icon-grey menu_item_not_selected"></span>
        </div>
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="metarStationMenuItemDiv" class="mapFooterMenuItem">
            <span id="metarStationMenuItemIcon" class="fa fa-temperature-half icon-grey menu_item_not_selected"></span>
        </div>
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="colorPickerItemDiv" class="mapFooterMenuItem">
            <span id="colorPickerItemClass" class="fa fa-crosshairs icon-grey menu_item_not_selected"></span>
        </div>
        <!-- <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="lightningItemDiv" class="mapFooterMenuItem">
            <span id="lightningItemClass" class="fa fa-bolt icon-grey"></span>
        </div> -->
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="drawMenuItemDiv" class="mapFooterMenuItem">
            <span id="drawMenuItemIcon" class="fa fa-pencil icon-grey menu_item_not_selected"></span>
        </div>
        <!-- <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="forecastMenuItemDiv" class="mapFooterMenuItem">
            <span id="forecastMenuItemIcon" class="fa fa-cloud-sun icon-grey"></span>
        </div> -->
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <div id="settingsItemDiv" class="mapFooterMenuItem">
            <span id="settingsItemClass" class="fa fa-sliders icon-grey menu_item_not_selected"></span>
        </div>
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span>
        <!-- <div id="toolsItemDiv" class="mapFooterMenuItem">
            <span id="toolsItemClass" class="fa icon-grey fa-circle-chevron-right"></span>
        </div>
        <span class="noselect">&nbsp;&nbsp;&nbsp;</span> -->
    </div>

    <!--
        MAP HEADER
    -->
    <div id="radarHeader" class="radarHeader">
        <!-- <div id="top-left" style="color: #a0a0a0; font-size: 15px; line-height: 17px; text-align: left !important;">
            <span><b style="font-weight: 900">AtticRadar</b><br>steepatticstairs.net</span>
        </div> -->
        <div id="top-right" style="font-weight: bold"></div>
        <span id="radarInfoSpan" style="display: none">
            <!-- <div style="font-size: 15px"><b>VCP: </b><a id='radarVCP'>None</a></div>
            <div style="font-size: 12px"><sus id='radarStationParent'><i class="fa-solid fa-circle-info" id="radarStationIcon" style="display: none">&nbsp;&nbsp;</i><b id='radarStation'>No Station Selected</b></sus><a id="radarTime"></a></div> -->
            <div style="font-size: 15px"><b class="icon-blue" id="radarStation" style="cursor: pointer">KLWX</b> <span id="radarLocation"></span></div>
            <div style="font-size: 13px; color: rgb(161, 161, 161)"><span id="radarVCP"></span></div>
        </span>
    </div>

    <!--
        THIS IS THE HTML FOR THE NEW MODAL (DIALOG) (i wrote it myself)
    -->
    <div id="atcDlg" style="display: none">
        <div id="atcDlgContainer">
            <div id="atcDlgHeader"><span id="atcDlgHeaderText">header</span><i id="atcDlgClose" class="fa fa-xmark"></i></div>
            <div id="atcDlgBody">body</div>
        </div>
    </div>

    <div id="hurricaneLegendDiv" style="display: none">
        <span class="hurricaneLegendCircle TD"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Tropical Depression</span>
        <br>
        <span class="hurricaneLegendCircle TS"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Tropical Storm</span>
        <br>
        <span class="hurricaneLegendCircle C1"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Category 1</span>
        <br>
        <span class="hurricaneLegendCircle C2"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Category 2</span>
        <br>
        <span class="hurricaneLegendCircle C3"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Category 3</span>
        <br>
        <span class="hurricaneLegendCircle C4"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Category 4</span>
        <br>
        <span class="hurricaneLegendCircle C5"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Category 5</span>
        <br>
        <span class="hurricaneLegendCircle NONTROPICAL"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Non-Tropical</span>
        <br>
        <span style="display: none" class="hurricaneLegendCircle OTHER"><span class="hurricaneLegendCircleInner">X</span></span>
        <!-- <span>Other</span>
        <br> -->
        <span class="hurricaneLegendCircle UNKNOWN"><span class="hurricaneLegendCircleInner">X</span></span>
        <span>Unknown</span>
    </div>

    <div id="attributionDiv" class="noselect">
        <b id="attributionDivContent">
            <span><b style="font-weight: 900; z-index: 1; position: relative; border-bottom: none;" class="attributionDivText">AtticRadar</b><br><span style="font-weight: normal" class="attributionDivText">steepatticstairs.net</span></span>
        </b>
    </div>

    <div id="colorScalePicker"></div>

    <div id="atticRadarMenu" style="display: none">
        <div id="atticRadarMenuContainer">
            <div id="atticRadarMenuBody">
                <div id="atticRadarMenuMainScreen" class="armScreen">
                    <div class="armsHeader">Menu<div class="armsHeaderExitBtn"><i class="fa fa-xmark"></i></div></div>
                    <br>
                    <div class="armrHeader">SETTINGS</div>
                    <div class="atticRadarMenuRow armrTop" id="armrSettingsBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-gear"></i>
                        Settings
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>
                    <div class="atticRadarMenuRow armrBottom" id="armrColortablesBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-palette"></i>
                        Colortables
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>

                    <br>

                    <div class="armrHeader">OPEN FILE</div>
                    <div class="atticRadarMenuRow" id="armrUploadFileBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-upload"></i>
                        Upload Radar File
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>

                    <br>

                    <div class="armrHeader">LAYERS</div>
                    <div class="atticRadarMenuRow armrTop" id="armrSPCOutlooksBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-cloud-bolt"></i>
                        SPC Outlooks
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle" id="armrHurricanesBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-hurricane"></i>
                        Hurricane Tracks
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter" onfocus="this.blur();" type="checkbox" role="switch" id="armrHurricanesBtnSwitchElem">
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle" id="armrTideStationsBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-ship"></i>
                        Tide Stations
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter" onfocus="this.blur();" type="checkbox" role="switch" id="armrTideStationsBtnSwitchElem">
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle" id="armrSurfaceFrontsBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-wind"></i>
                        Surface Fronts
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter" onfocus="this.blur();" type="checkbox" role="switch" id="armrSurfaceFrontsBtnSwitchElem">
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrBottom" id="armrWeatherRadioBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-radio"></i>
                        NOAA Weather Radio
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter" onfocus="this.blur();" type="checkbox" role="switch" id="armrWeatherRadioBtnSwitchElem">
                        </div>
                    </div>

                    <br>

                    <div class="armrHeader">INFO</div>
                    <div class="atticRadarMenuRow" id="armrAboutBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-circle-info"></i>
                        About
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>

                    <br>

                    <!-- <br>

                    <div class="armrHeader">WEATHER STATIONS</div>
                    <div class="atticRadarMenuRow" id="armrAtticStationBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-tower-broadcast"></i>
                        AtticStation
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div> -->

                    <!-- <div class="armrHeader">HURRICANES</div>
                    <div class="atticRadarMenuRow" id="armrHurricaneArchiveBtn">
                        <i class="armrIcon armrIcon-Blue fa-solid fa-hurricane"></i>
                        Hurricane Archive
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div> -->
                    <!-- <div class="atticRadarMenuRow armrTop">Contents Top</div>
                    <div class="atticRadarMenuRow armrMiddle">Contents Middle</div>
                    <div class="atticRadarMenuRow armrBottom">Contents Bottom</div>
                    <br>
                    <div class="atticRadarMenuRow">Contents Top</div> -->
                </div>
                <div id="atticRadarMenuSettingsScreen" class="armScreen" style="display: none">
                    <div class="armsHeader"><div class="armsHeaderBackBtn" id="armsSettingsBackBtn"><i class="fa fa-chevron-left"></i>&nbsp;Back</div>Settings<div class="armsHeaderExitBtn"><i class="fa fa-xmark"></i></div></div>
                    <br>
                    <div class="armrHeader armrHeaderWide">MAP LAYERS</div>
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrRadarVisBtn">
                        Radar
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrRadarVisBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrSTVisBtn">
                        Storm Tracks
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrSTVisBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrLightningVisBtn">
                        Lightning
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrLightningVisBtnSwitchElem">
                        </div>
                    </div>
                    <!-- <div class="atticRadarMenuRow armrMiddle armrWide" id="armrSPCOutlooksVisBtn">
                        SPC Outlooks
                        <i class="toggleSwitchContainter tscWide" id="armrSPCOutlooksVisBtnSwitch"><input type="checkbox" id="armrSPCOutlooksVisBtnSwitchElem" class="toggleSwitch" /><label for="armrSPCOutlooksVisBtnSwitchElem" class="toggleSwitchCircle">Toggle</label></i>
                    </div> -->
                    <!-- <div class="atticRadarMenuRow armrMiddle armrWide" id="armrLightningVisBtn">
                        Lightning
                        <i class="toggleSwitchContainter tscWide" id="armrLightningVisBtnSwitch"><input type="checkbox" id="armrLightningVisBtnSwitchElem" class="toggleSwitch" checked /><label for="armrLightningVisBtnSwitchElem" class="toggleSwitchCircle">Toggle</label></i>
                    </div> -->
                    <!-- <div class="atticRadarMenuRow armrMiddle armrWide" id="armrRoadsStreetsVisBtn">
                        Roads & Streets
                        <i class="toggleSwitchContainter tscWide" id="armrRoadsStreetsVisBtnSwitch"><input type="checkbox" id="armrRoadsStreetsVisBtnSwitchElem" class="toggleSwitch" /><label for="armrRoadsStreetsVisBtnSwitchElem" class="toggleSwitchCircle">Toggle</label></i>
                    </div> -->
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrDayNightLineVisBtn">
                        Day / Night Line
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrDayNightLineVisBtnSwitchElem">
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrBottom armrWide" id="armrHurricaneLegendVisBtn">
                        Hurricane Legend&nbsp;<i style="opacity: 50%">(when hurricanes enabled)</i>
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrHurricaneLegendVisBtnSwitchElem">
                        </div>
                    </div>
                    <!-- <div class="atticRadarMenuRow armrBottom armrWide" id="armrUSAMETARSBtn">
                        USA METARS Only
                        <i class="toggleSwitchContainter tscWide" id="armrUSAMETARSBtnSwitch"><input type="checkbox" id="armrUSAMETARSBtnSwitchElem" class="toggleSwitch" checked /><label for="armrUSAMETARSBtnSwitchElem" class="toggleSwitchCircle">Toggle</label></i>
                    </div> -->
                    <br>

                    <div class="armrHeader armrHeaderWide">MAP STYLES</div>
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrDarkMapBtn">
                        Dark
                        <div class="form-check form-switch">
                            <input class="map_style_button form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrDarkMapBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrLightMapBtn">
                        Light
                        <div class="form-check form-switch">
                            <input class="map_style_button form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrLightMapBtnSwitchElem">
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrBottom armrWide" id="armrSatelliteMapBtn">
                        Satellite
                        <div class="form-check form-switch">
                            <input class="map_style_button form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrSatelliteMapBtnSwitchElem">
                        </div>
                    </div>

                    <br>

                    <div class="armrHeader armrHeaderWide">ALERTS</div>
                    <!-- <div class="atticRadarMenuRow armrTop armrWide" id="armrEUPBtn">
                        <b style="font-weight: 900">Standard Alerts Only</b>
                        <i class="toggleSwitchContainter tscWide" id="armrEUPBtnSwitch"><input type="checkbox" id="armrEUPBtnSwitchElem" class="toggleSwitch" checked /><label for="armrEUPBtnSwitchElem" class="toggleSwitchCircle">Toggle</label></i>
                    </div> -->
                    <!-- <span style="display: block; margin-bottom: 0.75em;"></span> -->
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrWarningsBtn">
                        Warnings
                        <div class="form-check form-switch">
                            <input class="alert_options_btn form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrWarningsBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrWatchesBtn">
                        Watches
                        <div class="form-check form-switch">
                            <input class="alert_options_btn form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrWatchesBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrStatementsBtn">
                        Statements
                        <div class="form-check form-switch">
                            <input class="alert_options_btn form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrStatementsBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrMiddle armrWide" id="armrDiscussionsBtn">
                        Discussions
                        <div class="form-check form-switch">
                            <input class="alert_options_btn form-check-input toggleSwitchContainter tscWide" onfocus="this.blur();" type="checkbox" role="switch" id="armrDiscussionsBtnSwitchElem" checked>
                        </div>
                    </div>

                    <br>

                    <div class="armrHeader armrHeaderWide">DEALIAS</div>
                    <div class="atticRadarMenuRow armrWide" id="armrDealiasSettingsBtn">
                        Dealiasing Settings
                        <i class="armrIconArrowRight fa-solid fa-chevron-right"></i>
                    </div>
                </div>
                <div id="atticRadarMenuDealiasScreen" class="armScreen" style="display: none">
                    <div class="armsHeader"><div class="armsHeaderBackBtn" id="armsDealiasBackBtn"><i class="fa fa-chevron-left"></i>&nbsp;Back</div>Dealiasing Settings<div class="armsHeaderExitBtn"><i class="fa fa-xmark"></i></div></div>

                    <br>

                    <div class="armrHeader armrHeaderWide">ALGORITHM</div>
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrDealiasRegionBasedBtn">
                        Region Based
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide armrDealiasBtnSwitchElem" onfocus="this.blur();" type="checkbox" role="switch" id="armrDealiasRegionBasedBtnSwitchElem" checked>
                        </div>
                    </div>
                    <div class="atticRadarMenuRow armrTop armrWide" id="armrDealiasTornadicBtn">
                        Tornadic
                        <div class="form-check form-switch">
                            <input class="form-check-input toggleSwitchContainter tscWide armrDealiasBtnSwitchElem" onfocus="this.blur();" type="checkbox" role="switch" id="armrDealiasTornadicBtnSwitchElem">
                        </div>
                    </div>

                    <br>

                    <div>
                        <b>What does this mean?</b>
                        <br>
                        Dealiasing is the action of correcting issues in velocity sweeps.
                        When you load a Level 2 file and view its velocity data, a lot of the time,
                        the velocity values will seem wrong. There is a process to correct this, and it's called dealiasing.
                        AtticRadar implements two dealiasing algorithms.
                        <br><br>
                        The <b>Region Based</b> algorithm was originally developed for use in the python package <a href="https://github.com/ARM-DOE/pyart" style="color: #53a2e0;">pyart</a>.
                        I simply rewrote it in JavaScript, for use in AtticRadar. This algorithm is very robust, and is great at dealing with gaps in data, e.g. hurricanes.
                        <br><br>
                        The <b>Tornadic</b> algorithm is much better suited for dealing with velocity scans with tornado signatures, or tight rotation in general.
                        The region based algorithm struggles with these cases, so if you find an issue with that algorithm, you should try this one.
                        <br><br>
                    </div>
                </div>
                <div id="atticRadarMenuColortablesScreen" class="armScreen" style="display: none">
                    <div class="armsHeader"><div class="armsHeaderBackBtn" id="armsColortablesBackBtn"><i class="fa fa-chevron-left"></i>&nbsp;Back</div>Colortable Settings (BETA)<div class="armsHeaderExitBtn"><i class="fa fa-xmark"></i></div></div>

                    <br>

                    <div class="armrHeader armrHeaderWide">Reflectivity&nbsp;&nbsp;<i name="REF" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="REF_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrREF1ColortableBtn" name="REF1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="REF1_colortable_preview"></div>
                    </div>
                    <div class="atticRadarMenuRow colortableRow armrWide armrBottom" id="armrREF2ColortableBtn" name="REF2">
                        <span class="colortable_menu_text">RadarScope</span>
                        <div class="colortable_menu_image_preview" id="REF2_colortable_preview"></div>
                    </div>
                    <div class="atticRadarMenuRow colortableRow armrWide armrBottom" id="armrREF3ColortableBtn" name="REF3">
                        <span class="colortable_menu_text">NWS Default</span>
                        <div class="colortable_menu_image_preview" id="REF3_colortable_preview"></div>
                    </div>
                    <div class="atticRadarMenuRow colortableRow armrWide armrBottom" id="armrREF4ColortableBtn" name="REF4">
                        <span class="colortable_menu_text">GR2Analyst</span>
                        <div class="colortable_menu_image_preview" id="REF4_colortable_preview"></div>
                    </div>
                    <div class="atticRadarMenuRow colortableRow armrWide armrBottom" id="armrREF5ColortableBtn" name="REF5">
                        <span class="colortable_menu_text">RadarOmega</span>
                        <div class="colortable_menu_image_preview" id="REF5_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <div class="armrHeader armrHeaderWide">Velocity&nbsp;&nbsp;<i name="VEL" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="VEL_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrVEL1ColortableBtn" name="VEL1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="VEL1_colortable_preview"></div>
                    </div>
                    <div class="atticRadarMenuRow colortableRow armrWide armrBottom" id="armrVEL2ColortableBtn" name="VEL2">
                        <span class="colortable_menu_text">Balance</span>
                        <div class="colortable_menu_image_preview" id="VEL2_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <div class="armrHeader armrHeaderWide">Correlation Coefficient&nbsp;&nbsp;<i name="RHO" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="RHO_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrRHO1ColortableBtn" name="RHO1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="RHO1_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <div class="armrHeader armrHeaderWide">Differential Reflectivity&nbsp;&nbsp;<i name="ZDR" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="ZDR_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrZDR1ColortableBtn" name="ZDR1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="ZDR1_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <div class="armrHeader armrHeaderWide">Specific Differential Phase&nbsp;&nbsp;<i name="KDP" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="KDP_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrKDP1ColortableBtn" name="KDP1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="KDP1_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <div class="armrHeader armrHeaderWide">Vertically Integrated Liquid&nbsp;&nbsp;<i name="DVL" class="colortable_upload_btn fa fa-square-plus icon-green"></i></div>
                    <span id="DVL_ctable_options">
                    <div class="atticRadarMenuRow colortableRow armrWide armrTop" id="armrDVL1ColortableBtn" name="DVL1">
                        <span class="colortable_menu_check"><i class="fa fa-circle-check icon-blue"></i></span>
                        <span class="colortable_menu_text">Default</span>
                        <div class="colortable_menu_image_preview" id="DVL1_colortable_preview"></div>
                    </div>
                    </span>

                    <br>

                    <input type="file" id="hidden_colortable_file_uploader" style="display: none">
                </div>
                <div id="atticRadarMenuSPCScreen" class="armScreen" style="display: none">
                    <div class="armsHeader"><div class="armsHeaderBackBtn" id="armsSPCBackBtn"><i class="fa fa-chevron-left"></i>&nbsp;Back</div>SPC Outlooks<div class="armsHeaderExitBtn"><i class="fa fa-xmark"></i></div></div>

                    <br>
                    <div id="spcDataInfo"></div>
                    <br>

                    <!-- <div style="text-align: center; font-size: 20px; font-weight: bold;">CATEGORICAL</div> -->
                    <table style="width: 100%" class="spcTable">
                        <tr>
                            <th class="spcTable"></th>
                            <th class="spcTable">Day 1</th>
                            <th class="spcTable">Day 2</th>
                            <th class="spcTable">Day 3</th>
                        </tr>
                        <tr>
                            <td class="spcTable">Categorical</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-categorical-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-categorical-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-categorical-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-categorical-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-categorical-day3_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-categorical-day3_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                        </tr>
                        <tr>
                            <td class="spcTable">Probabalistic</td>
                            <td class="spcTable"></td>
                            <td class="spcTable"></td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-probabalistic-day3_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-probabalistic-day3_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                        </tr>
                        <tr>
                            <td class="spcTable">Tornado</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-tornado-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-tornado-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-tornado-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-tornado-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"></td>
                        </tr>
                        <tr>
                            <td class="spcTable">Wind</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-wind-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-wind-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-wind-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-wind-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"></td>
                        </tr>
                        <tr>
                            <td class="spcTable">Hail</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-hail-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-hail-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_convective-hail-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_convective-hail-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"></td>
                        </tr>
                    </table>

                    <!-- <br>

                    <div style="text-align: center; font-size: 20px; font-weight: bold;">FIRE</div>
                    <table style="width: 100%" class="spcTable">
                        <tr>
                            <th class="spcTable"></th>
                            <th class="spcTable">Day 1</th>
                            <th class="spcTable">Day 2</th>
                        </tr>
                        <tr>
                            <td class="spcTable">Dry TStorms</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_fire-dryt-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_fire-dryt-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_fire-dryt-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_fire-dryt-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                        </tr>
                        <tr>
                            <td class="spcTable">Wind & RH</td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_fire-windrh-day1_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_fire-windrh-day1_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                            <td class="spcTable"><div class="spcTableCellDiv"><input type="checkbox"
                                id="armrSPC_fire-windrh-day2_BtnSwitchElem" class="toggleSwitch spcToggleswitchBtn" /><label
                                for="armrSPC_fire-windrh-day2_BtnSwitchElem" class="toggleSwitchCircle spcToggleswitchCircle">Toggle</label></div>
                            </td>
                        </tr>
                    </table> -->
                </div>
            </div>
        </div>
    </div>

    <div id="psmTiltDropdownBackdrop" class="psm psmNoHideElem" style="display: none"></div>
    <div id="psmTiltDropdown" class="psm psmNoHideElem" style="display: none">
        <div class="psmTiltDropdownRow psmNoHideElem" value="1">Tilt 1</div>
        <div class="psmTiltDropdownRow psmNoHideElem" value="2">Tilt 2</div>
        <div class="psmTiltDropdownRow psmNoHideElem" value="3">Tilt 3</div>
        <div class="psmTiltDropdownRow psmNoHideElem" value="4">Tilt 4</div>
    </div>
    <div id="productSelectionMenu" style="display: none">
        <div id="wsr88d_psm" class="psm" style="display: none">
            <div class="psmSectionBreak"></div>

            <div class="psmSectionTitle">Super Resolution</div>
            <div class="psmRow noselect" value="ref">Super-Res Base Reflectivity<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="vel">Super-Res Base Velocity<div class="psmRowTiltSelect">Tilt 1</div></div>

            <div class="psmSectionBreak"></div>

            <div class="psmSectionTitle">Digital</div>
            <div class="psmRow noselect" value="rho">Correlation Coefficient<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="zdr">Differential Reflectivity<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="hyc">Hydrometer Classification<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="hhc">Hybrid Hydrometer Classification<div class="psmRowTiltSelect blankText">Tilt 1</div></div>
            <div class="psmRow noselect" value="vil">Vertically Integrated Liquid<div class="psmRowTiltSelect blankText">Tilt 1</div></div>
            <div class="psmRow noselect" value="kdp">Specific Differential Phase<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="lowres-ref">Digital Base Reflectivity<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="lowres-vel">Digital Base Velocity<div class="psmRowTiltSelect">Tilt 1</div></div>
        </div>
        <div id="tdwr_psm" class="psm" style="display: none">
            <div class="psmSectionBreak"></div>

            <div class="psmSectionTitle">TDWR</div>
            <div class="psmRow noselect" value="sr-ref">Short-Range Reflectivity<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="lr-ref">Long-Range Reflectivity<div class="psmRowTiltSelect">Tilt 1</div></div>
            <div class="psmRow noselect" value="tdwrVel">Base Velocity<div class="psmRowTiltSelect">Tilt 1</div></div>
        </div>
        <div id="level2_psm" class="psm" style="display: none">
            <div id="completeDealiasBtnContainer" style="display: none">
                <div id="dealiasToggleSwitchContainer" style="display: flex; justify-content: space-around; align-items: center;">
                    <div class="l2ElevationBtn dealiasBtnDeSelected l2elev-nonstandard noselect" id="dealiasBtn" style="width: 100%">
                        <i class="fa-solid fa-xmark"></i>&nbsp;&nbsp;Dealias
                    </div>
                </div>
                <i id="dealiasSettingsIcon" class="fa-solid fa-gear l2ElevationBtn l2elev-nonstandard"></i>
                <br><br>
            </div>
            <!-- <div id="l2ElevButtonsExpander" style="display: flex; justify-content: space-between; align-items: center;">
                <span>Elevations</span>
                <span id="l2ElevButtonsExpanderIcon" class="fa fa-chevron-right" style="font-size: 18px"></span>
            </div>
            <div id="l2ElevButtons" class="l2ElevButtons" class="container" style="display: none"></div> -->
            <!-- <span class="l2ElevBtn">0.5</span>
            <span class="l2ElevBtn">1.5</span>
            <span class="l2ElevBtn">2.5</span> -->
            <div id="l2ElevationButtons" class="container">
                <!-- <div class="row gx-1" style="margin-top: 0.25rem">
                    <div class="col">
                        <div class="l2ElevationBtn" value="1">0.5°</div>
                    </div>
                    <div class="col">
                        <div class="l2ElevationBtn" value="1">0.5°</div>
                    </div>
                    <div class="col">
                        <div class="l2ElevationBtn" value="1">0.5°</div>
                    </div>
                </div> -->
            </div>
            <div class="psmSectionBreak"></div>

            <div class="psmSectionTitle">Level II Products</div>
            <div class="psmRow l2prodSel noselect" value="l2-ref">Reflectivity</div>
            <div class="psmRow l2prodSel noselect" value="l2-vel">Velocity</div>
            <div class="psmRow l2prodSel noselect" value="l2-rho">Correlation Coefficient</div>
            <div class="psmRow l2prodSel noselect" value="l2-zdr">Differential Reflectivity</div>
            <div class="psmRow l2prodSel noselect" value="l2-sw">Spectrum Width</div>
            <div class="psmRow l2prodSel noselect" value="l2-phi">Differential Phase Shift</div>
        </div>
    </div>

    <!-- <div id="chart_container"></div> -->

    <div id="colorPicker" class="colorPicker colorPickerCircle"></div>
    <div id="colorPickerBorder" class="colorPicker colorPickerCircle">
        <div id="verticalLine" class="colorPicker"></div>
        <div id="horizontalLine" class="colorPicker"></div>
        <div id="radarCenterLine" class="colorPicker"></div>
    </div>
    <div id="colorPickerText" class="colorPicker">
        <div id="colorPickerTextValue" style="font-weight: bold"></div>
        <div id="colorPickerTextBeamHeight" style="font-size: 15px; font-style: italic; opacity: 50%">12.3 mi</div>
    </div>

    <div id='optionsBox' style="display: none">
        <div id="smallInfo" style="display: none"></div>
        <div id="mainInfo" style="display: none"></div>
    </div>
    <div id="stationInp" style="display: none"></div>
    <canvas id="theCanvas" style="display: none"></canvas>
    <canvas id="texturecolorbar" style="display: none" class="texturecolorbar" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Default tooltip" data-bs-animation="false"></canvas>
    <canvas id="mapColorScale" class="screenshot"></canvas>
    <!-- <canvas id="mapColorScale"></canvas> -->

    <div id="map" class="screenshot"></div>

    </div>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DFPY4VLRJR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-DFPY4VLRJR');
    </script>

    <script>
        window.longProductNames = {
            'ref': 'Super-Res Base Reflectivity',
            'vel': 'Super-Res Base Velocity',
            'rho': 'Correlation Coefficient',
            'zdr': 'Differential Reflectivity',
            'hyc': 'Hydrometer Classification',
            'hhc': 'Hybrid Hydrometer Classification',
            'sw ': 'Base Spectrum Width',
            'lowres-ref': 'Digital Base Reflectivity',
            'lowres-vel': 'Digital Base Velocity',
            'vil': 'Vertically Integrated Liquid',
            'kdp': 'Specific Differential Phase',
            'srv': 'Storm Relative Velocity',
            'sr-ref': 'Short-Range Reflectivity',
            'lr-ref': 'Long-Range Reflectivity',
            'tdwrVel': 'Base Velocity'
        }

        function _set_progress_bar_width(width_percent) {
            if (width_percent >= 100) { width_percent = 100 }
            const elem = document.getElementById('loadingLibrariesProgressBarInner');
            elem.style.right = '4px';
            const width = elem.offsetWidth;
            elem.style.right = `${width - ((width * (width_percent / 100)) - 4)}px`;
        }

        var sum = [];
        var already_loaded = 0;
        function _progress_download(url, byte_length, total_byte_length, callback) {
            const split = url.split('/');
            const filename = split[split.length - 1];
            document.getElementById('progressBarText').innerHTML = filename;

            var req = new XMLHttpRequest();

            var temp = 0;
            req.addEventListener('progress', function (event) {
                const loaded = event.loaded;
                const new_bytes = loaded - temp;
                temp = loaded;
                already_loaded += new_bytes;

                _set_progress_bar_width((already_loaded / total_byte_length) * 100);
            }, false);

            req.addEventListener('load', function (event) {
                sum.push(temp);
                /* For individual file sizes */
                // console.log(url, temp);
                /* For the total file size of all libraries combined */
                // console.log(sum.reduce((p, a) => p + a, 0));

                var e = event.target;
                callback(e.response);
            }, false);

            req.responseType = 'arraybuffer';
            req.open('GET', url);
            req.send();
        }

        function _add_to_head(text, type) {
            if (type == 'js') {
                const script = document.createElement('script');
                script.type = 'text/javascript';
                script.innerHTML = text;
                document.head.appendChild(script);
            } else if (type == 'css') {
                const style = document.createElement('style');
                style.textContent = text;
                document.head.appendChild(style);
            }
        }

        function add_script_tag(type, url, byte_length, total_byte_length, compressed, cb) {
            if (type == 'js') {
                _progress_download(url, byte_length, total_byte_length, (arraybuffer) => {
                    var string = new TextDecoder('utf-8').decode(arraybuffer);
                    if (compressed) {
                        const inflated = pako.inflate(arraybuffer, { to: 'string' });
                        string = inflated;
                    }

                    _add_to_head(string, type);
                    cb();
                })
            } else if (type == 'css') {
                _progress_download(url, byte_length, total_byte_length, (arraybuffer) => {
                    var string = new TextDecoder('utf-8').decode(arraybuffer);

                    // from ChatGPT - seems to fix issues with relative paths for remote CSS files
                    const base_url = url.substring(0, url.lastIndexOf('/') + 1);
                    string = string.replace(/url\((?!['"]?(?:https?:|data:))/gi, 'url(' + base_url);

                    _add_to_head(string, type);
                    cb();
                })
            }
        }

        var total_byte_length;
        // from ChatGPT
        function _add_libraries(library_configs, callback) {
            if (total_byte_length == undefined) {
                total_byte_length = library_configs.reduce((acc, curr) => acc + curr[2], 0);
            }

            if (library_configs.length === 0) {
                // Base case: all libraries have been loaded
                callback();
                return;
            }

            const config = library_configs.shift();
            const type = config[0];
            const path = config[1];
            const byte_length = config[2];
            const compressed = config[3];

            add_script_tag(type, path, byte_length, total_byte_length, compressed, function () {
                // Callback function after the library is loaded
                _add_libraries(library_configs, callback);
            });
        }

        function load_all_libraries(library_configs, callback) {
            function _pre(cb) {
                fetch('./tools/size.txt')
                .then(response => response.json())
                .then(json => {
                    cb(json);
                })
            }
            _pre((filesizes) => {
                library_configs[library_configs.length - 2][2] = filesizes['index.css'];
                library_configs[library_configs.length - 1][2] = filesizes['bundle.js'];

                _add_libraries(library_configs, callback);
            })
        }

        document.getElementById('bodyDiv').style.display = 'none';
        load_all_libraries([
            ['js', 'https://code.jquery.com/jquery-3.2.1.min.js', 86659],
            ['js', 'https://code.jquery.com/ui/1.13.1/jquery-ui.min.js', 255082],
            ['css', 'https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css', 36099],

            ['css', 'https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css', 36640],
            ['js', 'https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js', 971097],

            // https://cdnjs.com/libraries/font-awesome
            ['css', 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css', 100782],

            // https://getbootstrap.com/docs/5.2/getting-started/download/
            // ['css', 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css', 232855],
            // ['js', 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js', 80668],

            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js', 33871],
            ['css', 'https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.min.css', 15733],

            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js', 311096],

            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js', 441542],

            // https://getbootstrap.com/docs/5.2/components/tooltips/
            // ['js', 'https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js'],

            // https://github.com/manuelbieh/geolib
            // ['js', 'https://cdn.jsdelivr.net/npm/geolib@3.3.3/lib/index.min.js', 16048],

            // https://developers.google.com/chart/interactive/docs/gallery/linechart
            // ['js', 'https://www.gstatic.com/charts/loader.js'],

            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js', 97587],
            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/togeojson/0.16.0/togeojson.min.js', 5978],

            // ['js', 'https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.5.0/math.js'],

            // https://github.com/webgeodatavore/GeoJSON.Terminator
            ['js', 'https://unpkg.com/@webgeodatavore/geojson.terminator@1.0.0/GeoJSON.Terminator.js', 5819],

            // ['js', 'https://unpkg.com/gpu.js@2.16.0/dist/gpu-browser.min.js'],

            // https://spin.js.org/
            // ['css', 'https://cdnjs.cloudflare.com/ajax/libs/spin.js/4.1.1/spin.css', 609],
            // ['js', 'https://spin.js.org/spin.umd.js', 7274],

            ['js', 'https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js', 46859],

            // ['js', 'https://code.highcharts.com/highcharts.js', 288146],

            // ['js', 'https://cdnjs.cloudflare.com/ajax/libs/flot/4.2.4/jquery.flot.js', 106707],

            // ['js', 'http://www.flotcharts.org/flot/source/jquery.canvaswrapper.js', 20289],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.colorhelpers.js', 6447],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.flot.js', 105004],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.flot.saturated.js', 1290],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.flot.browser.js', 4235],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.flot.drawSeries.js', 24366],
            // ['js', 'http://www.flotcharts.org/flot/source/jquery.flot.uiConstants.js', 254],

            ['js', './lib/flot/jquery.event.drag.js', 7061],
            ['js', './lib/flot/jquery.mousewheel.js', 2579],
            ['js', './lib/flot/flot.combined.js', 354389],
            // https://github.com/krzysu/flot.tooltip
            // ['js', './lib/flot/jquery.flot.tooltip.js', 23784],

            // ['js', './app/hurricanes/historical/stormList.js'],

            ['css', './index.css', 0],

            ['js', './dist/bundle.js', 0],
        ], () => {
            document.getElementById('bodyDiv').style.display = 'block';
            document.getElementById('loadingLibrariesDiv').style.display = 'none';
        })
    </script>
</body>
</html>